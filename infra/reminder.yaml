apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ketchup-reminder
  namespace: default
spec:
  interval: 120m
  chart:
    spec:
      chart: cron
      version: "0.0.27"
      sourceRef:
        kind: HelmRepository
        name: vibioh
        namespace: default
      interval: 120m
  install:
    crds: Skip
  maxHistory: 3
  upgrade:
    remediation:
      retries: 3
  rollback:
    cleanupOnFail: true
  values:
    nameOverride: ketchup-reminder
    jobLabels:
      k8s-cleaner: "true"
    schedule: "0 16 * * 5" # manager is in UTC
    image:
      name: vibioh/ketchup
      tag: "202212031021" # {"$imagepolicy": "default:flux-ketchup-web:tag"}
    config:
      KETCHUP_DB_HOST: postgres
      KETCHUP_DB_NAME: ketchup
      KETCHUP_DB_PORT: "80"
      KETCHUP_DB_USER: ketchup
      KETCHUP_LOGGER_JSON: "true"
      KETCHUP_TRACER_URL: http://jaeger.monitoring:14268/api/traces
      OTEL_SERVICE_NAME: ketchup-reminder
    secrets:
      KETCHUP_DB_PASS: AgABdcJBitM657gDVH4zhalAIXDPazxq1fILfo6rKOxivOx2zR6yKnmwJ35d5fau3jr8q7Ucsx61wWxu+d6gMOQe849WLOBN00sFku97GgGFMQKwG7ZvE/0pKCfNU56dddIxmiy7sWooeli57Q+tpcJr4OVnbPhCHpYD42a7JOoihk5J0waVn0yzc5fxcioRgwwu7w78S/Zv3F24KBTrSXY5nIHcpplruNYb4vNYt9lg+0ScdsdV2yStdqO8q55meLm6X35kJrGVcRb63sJw3NeYV5UmzQ7W59KZ7O6RHGtLqnWe8pTODJIQt3ZLBZ9SrHj7shUQfQff0jjYPDAL6FlhfGoGz4o4NmmciBShU+m2Rd1SJm4WQR1Oc/59jgGwIlPXXvun/iWUaMJrcRd7BGf9kw2g+Fo5ks/65nlD++P1d79/SSxOHNiIw7xA9pMhWFlbKX1gtuwAEV2rOZzBAjctS+aiq+jQk4kh3FR2ZzT0gxVQf2immfoOAcjLugRhTOK/0ZrEx0iHy417Kd1Uku9ieZbJ74X/dvFtv2XRLm86cggZTNBkPcdoYZdgtmse+5YOFidHoap4QPyu1zSAbqW6wllj8Ku7or2s5BPVP2ztD4vIxVtJcw1H99CFqDQdz4KVfEq29aZm9tXskWLVvtyhraOKOQ6LDRovNyGbC0C5ZEFEhGLI4pdG5OK3vm3v8LcsiccaJbyDDC3WXOI+VoAyo7DQ9eP9VX3bVdX+QWY6CZpoLobjLZQrLKLeSvX+qeMoilyQKzPWP4L53UI=
      KETCHUP_MAILER_URL: AgAmLSPAAbyQrUTkjtC3yNwxCkfBjHpFrKYEQumvyGo7APg+zahRDGquu9vD2OVDMIbbfC5o6BXVCSkinf9QcvAWCAqjSTdhlqfMFEwQ6psShDMAIsPueXs9qnXQTYycklBJq5vzPSPdlJ3CtUzyRiQMfNt9E7MHpwGQph1hFjvWNwK19s+aRceCJ1mI/1TGAgTdxE2Uaae+hbcngguxX2ur8YUgzBZJClDwU5xc2QDG5DwVKINLRcB1SMAU/lzZO1TtjRvM+dGD+cRigTDIYWJHKT0kGOHV93mhzt3TuyLh88z1vn4JXzgKi3DsnzsfibTXn7HhCyJi6Rs9+RgOVPDd5qfUkdW/yxYpoml+qlVs1wtsXkvHn24H+DZ4UCYTko6QliVn/qt7YqR8g8hWdz5GTz5b2Dvb8ETnqqQLzzt0uvZ6+AfGK5vQ0qySaKkMkmaF1VhjEYpkmnickDk2gM2k68jyuiUTzgdm5EreoKuT5Xtzel0WAvQKG0cSJe0abmHB7j1C5kSLI8XW+YHeCi6rjfIbtTsQ+XtahzDn3cF8UugpKXv7+GT9P24gpKS9PowruQ76cAzL4Y1x7OaBO938tvCdz/2+SCSN2WhoM2BJ7UTG49ttU8IiAOMdhJWnsM/WNm9kP+5bWiLX1XWEN3mKrwrIiDLLhaE3mfje9dX85vSZaHG2NVs4DDY54Wa3QCOvkXRC7zEdu16z3mShA4wSC65b5yx3h6Ii0rZ4W2XUbzkenOt1WKhXuQODgPjTTtJekLQ=
    containers:
      - name: job
        command:
          - /notifier
          - -notification
          - "reminder"
    resources:
      limits:
        memory: 128Mi
