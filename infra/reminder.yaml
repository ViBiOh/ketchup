apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ketchup-reminder
  namespace: default
spec:
  interval: 120m
  chart:
    spec:
      chart: cron
      version: "0.0.25"
      sourceRef:
        kind: HelmRepository
        name: vibioh
        namespace: default
      interval: 120m
  install:
    crds: Skip
  maxHistory: 3
  upgrade:
    remediation:
      retries: 3
  rollback:
    cleanupOnFail: true
  values:
    nameOverride: ketchup-reminder
    jobLabels:
      k8s-cleaner: "true"
    schedule: "0 16 * * 5" # manager is in UTC
    image:
      name: vibioh/ketchup
      tag: "202208070852" # {"$imagepolicy": "default:flux-ketchup-web:tag"}
    config:
      KETCHUP_DB_HOST: ketchup-db
      KETCHUP_DB_NAME: ketchup
      KETCHUP_DB_PORT: "80"
      KETCHUP_DB_USER: ketchup
      KETCHUP_LOGGER_JSON: "true"
      KETCHUP_TRACER_URL: http://jaeger.monitoring:14268/api/traces
      OTEL_SERVICE_NAME: ketchup-reminder
    secrets:
      KETCHUP_DB_PASS: AgC04HIjfTtE5sabRjuPjmAfjFm0X98U/LSgRyEcGsYV3wSgkeEwvRWXD/rEpI25caT/fa7yZ6uZyK343H70AWfRsp38XasEzhoL9ill8FEjIxkt9S2VgU7mZJwl8amS0RuynSxPDmKYW4kWvPlz4st5vMMxLO29O467y/VxOJTcsLa/cnenJ6cUSmOk3YjbkDfd9ih1K1qGJGGJE0ArAf8LKdqvzNvUVcni1qQBy+RDFCfZ4WoxYiGqiG14jgKb65Mve8GwQVW6EVgMCzkigTJkL5cMpqZXDnbQ2sxFNm8YuZRA9ZEEg7t4l+Og36IbSdWqvyYWydwhukXC54zsA4+VAs+7YcgldC4DmwtwAO9HEB0JUTV+rKbXdX6TRlsu0Jh+YoYUj1Rs6YN6g2dLSJ/6RSDpt1/Zi/q0Yg6K7KDhP9Z7AmK7hJj+7MPtR+JhH99sESy4VGYbJKt4RpdDj2lwKf8p3Cq8/XyM1W/SdvFGGWq0iW2unQ9v+JDm35vDKc45bJ/B5rDPJkqQsvHgDLPW9QU6RQvuF1Mc88spKZY7vJlM5iXI5qHbaTiNUxuVm0DBIEJeVbcTJzxmqe0j7uAvqfqyLDtO5RWxE8xVrQWp9mrGmBdmG6R4HCcib2AMu9qYwxi/Iwwrm4gEh0zKYVw2XMYLQ6EUoJDNx8Ob6HxFzMa3RbsVc19YYIanqGHurrCshmhbWhv8YVH93XP04L9vDGiN0FzeQbX7l/I43lOytPhEpMoh8VyYQCFO6b7Cur3UkK5NL5xfoClYokU=
      KETCHUP_MAILER_URL: AgAmLSPAAbyQrUTkjtC3yNwxCkfBjHpFrKYEQumvyGo7APg+zahRDGquu9vD2OVDMIbbfC5o6BXVCSkinf9QcvAWCAqjSTdhlqfMFEwQ6psShDMAIsPueXs9qnXQTYycklBJq5vzPSPdlJ3CtUzyRiQMfNt9E7MHpwGQph1hFjvWNwK19s+aRceCJ1mI/1TGAgTdxE2Uaae+hbcngguxX2ur8YUgzBZJClDwU5xc2QDG5DwVKINLRcB1SMAU/lzZO1TtjRvM+dGD+cRigTDIYWJHKT0kGOHV93mhzt3TuyLh88z1vn4JXzgKi3DsnzsfibTXn7HhCyJi6Rs9+RgOVPDd5qfUkdW/yxYpoml+qlVs1wtsXkvHn24H+DZ4UCYTko6QliVn/qt7YqR8g8hWdz5GTz5b2Dvb8ETnqqQLzzt0uvZ6+AfGK5vQ0qySaKkMkmaF1VhjEYpkmnickDk2gM2k68jyuiUTzgdm5EreoKuT5Xtzel0WAvQKG0cSJe0abmHB7j1C5kSLI8XW+YHeCi6rjfIbtTsQ+XtahzDn3cF8UugpKXv7+GT9P24gpKS9PowruQ76cAzL4Y1x7OaBO938tvCdz/2+SCSN2WhoM2BJ7UTG49ttU8IiAOMdhJWnsM/WNm9kP+5bWiLX1XWEN3mKrwrIiDLLhaE3mfje9dX85vSZaHG2NVs4DDY54Wa3QCOvkXRC7zEdu16z3mShA4wSC65b5yx3h6Ii0rZ4W2XUbzkenOt1WKhXuQODgPjTTtJekLQ=
    containers:
      - name: job
        command:
          - /notifier
          - -notification
          - "reminder"
    resources:
      limits:
        memory: 128Mi
