apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ketchup-reminder
  namespace: default
spec:
  interval: 120m
  chart:
    spec:
      chart: cron
      version: "0.0.19"
      sourceRef:
        kind: HelmRepository
        name: vibioh
        namespace: default
      interval: 120m
  install:
    crds: Skip
  maxHistory: 3
  upgrade:
    remediation:
      retries: 3
  rollback:
    cleanupOnFail: true
  values:
    nameOverride: ketchup-reminder
    schedule: "0 16 * * 5" # manager is in UTC
    image:
      name: vibioh/ketchup
      tag: "202111032139" # {"$imagepolicy": "default:flux-ketchup-web:tag"}
    config:
      KETCHUP_DB_HOST: ketchup-db
      KETCHUP_DB_NAME: ketchup
      KETCHUP_DB_PORT: "80"
      KETCHUP_DB_USER: ketchup
      KETCHUP_LOGGER_JSON: "true"
    secrets:
      KETCHUP_DB_PASS: AgAw+m39PXVIRub8NNvEenJC1CuqSraj0//3FUlhc5NV4cLT0lr15v7oIsd+LyLD65iirArC+03AJ7NQ6HQ/G4a0ARY/mljIFw82+lvZXCF22KvUrJ9CXRY/4ugARluGNwNbUmxO+2frON7G8Ek4GzxyUQK54h2esRWf9Ev7yTz/tfWCEg2JteMWMJ340glCIGUlY1V23GA2ucYmvSBEx8Svifs20lRFrWO0GHs5/gLYP9z4oFbEHO3fLH6a3WM0xiPZQ0I1wnJApRTKe/qraihlCxSz1PfJyELeoP3pEeuJ7M/J8kr/ryJDeI8f4ZSnJ1nbeP6e2VhWd/trGeNBnDbgnVwv/Ycsl15GC3OpD+qEuQtYGLa/zJS7GriLsQ+4uPkXPPhr45nhpiMouInnkw05ZX68V5c/aWDTVY3NNUAPuWL/VV0zq7OLDtokLiD/wS8XsG+XtewVMx6opvDYXqyUBbg2tbW96xdyCnRWfhE/LWdxirRaYKirGV4zRjD6icgd7xgkmzDngk1CfoSXVfUzklMI+P0ekE8Sds1zxKKdsIPwQ/dmorC0Uv98JYc194Ax6Kk7+9q5MBwUuNlU3IOCQuEF72MVsJM3rfSWou+m28bEFIiI6fI7DDCNmvZ5bhDva/KN7A8bLAltpv+ITCv5IJW9ejNVRiy90gdTm4GUPA9XZTDNdpU425DyCKQFOU+XPSpBsR2CDsZnyPMBlFqDnO3m7Mc1QOhENQO986KIEt/WRwQGXb5j+hz/L+Bn9co1SE3nfr8jxFV2CIk=
      KETCHUP_MAILER_URL: AgAxlp+YpMSMQPJFQ/mpzfIBL7b3481XO1QQgm6cys/xql6u49mbF1YBQeoFSE1telRhPbfFcbAT5PXuz6Jljr2kSg8iTT5L1u+96fxUYGoLPLfTsq1stPvohALgDxAPs8qiaw+OvLVszfTOBVtTXwJpTi7/08XVrVcKgKuFPG4GPB71EVsXEV1yK+UxJLjSICM1OQ8pIzVxBWwLYn2rVB/zcRVnYtjWQN8dPerQvG4iF40HfdN1VfPf58OOZsIavTTjIh10jO0t/+k0iR7B5W239uYA2EI8foySF/geNjxvpw7HRQvZs44pXVDGdsF/5LB138AqrdegMJ6/1/G7yGS0fEx6y7SjEcUb7CIjZJCZNd5GsonYPQa+dja61RLb4NSHT5QTnw5s0zeTjWE2JpuGHlWihxQ9NKGSY/oLUMLWbsnbfzs9Z++ZP8Bq1UyYApWcFQBcQdmJcqmuLL6dtKbzDtHTtPmE8aDqq2mSXhKX8j5TDmGM2uG9a/ijFV3IgUdTRZaYDM9LEqOctVpAcYgfTytaf3ADxOJKHVBpvRTMOsByzJ5TGruw8p2gcwSgOO1kHcNbR7n28mDHIkGYMevrdzvLKENMYCV/97rUrK7CSLFxia47ITe/q5ak8V94EyoklTESs+YT1jNF+EkNb7nL1r6axNiAnbQizQ8J4078dSofrFPzlDY6s0jmUOMt8q3I+d0MpkNAQ0vhuqXy0OBj4w3D2Lpi2tqEFJiQ8aXDH5j3IOr4MSHg27KL+hjfzxs0JVVFbMIAyOSBKZThoOls9DlmqNmBBegaEhPR2ehT1BpsMBbq
    containers:
      - name: job
        command:
          - /notifier
          - -notification
          - "reminder"
    resources:
      limits:
        memory: 128Mi
