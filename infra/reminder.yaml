apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ketchup-reminder
  namespace: default
spec:
  interval: 120m
  chart:
    spec:
      chart: cron
      version: "0.0.25"
      sourceRef:
        kind: HelmRepository
        name: vibioh
        namespace: default
      interval: 120m
  install:
    crds: Skip
  maxHistory: 3
  upgrade:
    remediation:
      retries: 3
  rollback:
    cleanupOnFail: true
  values:
    nameOverride: ketchup-reminder
    jobLabels:
      k8s-cleaner: "true"
    schedule: "0 16 * * 5" # manager is in UTC
    image:
      name: vibioh/ketchup
      tag: "202207111530" # {"$imagepolicy": "default:flux-ketchup-web:tag"}
    config:
      KETCHUP_DB_HOST: ketchup-db
      KETCHUP_DB_NAME: ketchup
      KETCHUP_DB_PORT: "80"
      KETCHUP_DB_USER: ketchup
      KETCHUP_LOGGER_JSON: "true"
      KETCHUP_TRACER_URL: http://jaeger.monitoring:14268/api/traces
      OTEL_SERVICE_NAME: ketchup-reminder
    secrets:
      KETCHUP_DB_PASS: AgArVhN8+q+SgKdUeVGqhJlbuOuqcJ9qeTdTSPTz6Ffilg6eHkqJnq3DaqSUEp24s/WQ0H7pHJ1u2oxKfJ7Jnvo5km1ZnwX3ZjNE+zGSlvVVnUzFeflAWhBSUvVY4/sBy5Q0eqqtD0h1/SL9JGg9TxTtPTFUsim4IeSddfRkMFHdO0p6FE1yvxD1G8gDGTZ0aQlW29NUREQie4CnDlewYtVDlQxVLxCAxz8mb1iANpO6LOGShBf+e3u/bxqZbgGU4+3LgFJPpGrqXxzGoth7kSK8Ai2U9iiDqgQqpW2G/PdzI2b+35uaex/9M43r+D7C5TSssKH+yIQfgWYRHmpagSveaaJ6qLNoojQD872tlaCYj6zxrIBcJHxu4V1U5V+w5Fbji4lVSexN6lJtoOZR1bcsnTZgxUHGvrbRjqrb5PFXgm4pK6gxRh65414hvkmBmZ09c47Q8IJLUXRKNAkrek0nOjiHd6ueYcoYipG1Pq3gE2cCagoT67nZePGr6esqOuFELVXb4wgKw9Wqndj0++zQRIZFkshecalRzyrFY3T7WOczo8GVASPE7jAOi7TcyX5lXpVwtTupqVyV678C/MAKTqE9uUfXKq9lFyguUQrbJb2fMvgBHuyDF/XSLP1VV6+tV54UWKxMxYhPHZU/JqLGOKbNyB7Xd54OxoKHLd6QXz9W64fWfIXxYBh2d/XYMOp4Rtya+xQIl1UDLumpFNsBmcaDQhs2GHDC8mbe8vd6A5RfwUejb5lWf08dohoIeIGkskVNpn/YPhijg4A=
      KETCHUP_MAILER_URL: AgBjtJW6lkI741ysOW06F6nu0xYEP8GdqLakWlQm0qduMSf3Fvyi4kedf8KhpkdUuRKP/djkWRseGuUWI+lVn2+lxDKLRLfIhSd/roLUrYTXvyj0gczisbgeGqwW6pEiB6LXmsPWCEFiJqD25opIs52wCBfRPJ8Pdwtqtv4Vsg1QC9Bj0hqfp5N4qytf5hGcF8n5Yo2viQXuHrkqVSbs3DbAVhtMqs2eMnCQtmzN6OnLTHa0EovefsRpLVgfxwoOOj6JrGw3D7o5sCzlf5Q7uRZNmEpXOwapBk9spw3Nvp82zUVlZRJ83J/nLAG3qUhgmTlfdwqrQz0VYj0H+VIvSd9J26867bUU4lzalht0mIbzLm4GFhmNpGQq4zKcONfhKu1uXrfm4XBkl3VZk/I7Ghk58bjS2QK+P9nrLIF6a0ZKW5V3MLhw3WBnY/AUrtClgE7dN6neVP95IBi5TqW2RNb5Y/Lk238BYT+c15PPWbSDXsSqoPuZgJqx/vtwronlO5ynlDf6y4oa/jqEhfD6sGVRk8b9INsFHvqHmOCLt4fShi5bqVPJompWHrqBPgdbab0MlRbUWSdDVoIzXOxWRbqg4iX2J7rob4lPVKMyRUKsIp7TFpl8KxavoPXxrmxIiR5H61pduvDsgeT5QO42gFUyUF3FyTenbRCD10nkGUg1KNtNY1wdW3B3npYXqgWF5q8qgvjiayFKAGAGgZ0wPQ4bUuLr7PPQZ0XOQ5iwv/A4I5NSlPZXeLpjxsF7lUEqruNErqg=
    containers:
      - name: job
        command:
          - /notifier
          - -notification
          - "reminder"
    resources:
      limits:
        memory: 128Mi
