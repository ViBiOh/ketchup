apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ketchup-notifier
  namespace: default
spec:
  interval: 120m
  chart:
    spec:
      chart: cron
      version: "0.0.25"
      sourceRef:
        kind: HelmRepository
        name: vibioh
        namespace: default
      interval: 120m
  install:
    crds: Skip
  maxHistory: 3
  upgrade:
    remediation:
      retries: 3
  rollback:
    cleanupOnFail: true
  values:
    nameOverride: ketchup-notifier
    jobLabels:
      k8s-cleaner: "true"
    schedule: "0 7 * * *" # manager is in UTC
    image:
      name: vibioh/ketchup
      tag: "202207111530" # {"$imagepolicy": "default:flux-ketchup-web:tag"}
    config:
      KETCHUP_DB_HOST: ketchup-db
      KETCHUP_DB_NAME: ketchup
      KETCHUP_DB_PORT: "80"
      KETCHUP_DB_USER: ketchup
      KETCHUP_LOGGER_JSON: "true"
      KETCHUP_NOTIFIER_PUSH_URL: http://pushgateway.monitoring
      KETCHUP_DOCKER_USERNAME: vibioh
      KETCHUP_TRACER_URL: http://jaeger.monitoring:14268/api/traces
      OTEL_SERVICE_NAME: ketchup-notifier
    secrets:
      KETCHUP_DB_PASS: AgAT97y/bymz0HCaRVvasaegeFVV37CazMJFhFhXVSMqVMrJogx+QIFodV0OPLxPNjs5izN+aGT/IU/psAMDHUo5LuwlhBPYjjCLo8H3HJ205xdq1arxncccSxsBsJknhhbRuL+mo7NpY+AH4p5JCrFy0S9soL2h34lrsL6yC+u26NgIcjG4KhDX5V5KA7jl4rFqlFdPH1265LGOLbYRj8dh7HzR157e+VhcpPApPs+gxkvDhjhi3VjTA928YfBo92WkYqiS5k9I9Os1Z78W5pxT/YvE+aEdaNJxBC7rJE3OhTIV/5/sRb5ONMfGCTcAc2JfIHLqi5Op0kBerJI6Kn/VoNZQdzFm42IvHGYqcBLU7ELQS3WmBKLZNfMIBGIBRooL4rYgnJOPc7MvTA6Embi29G81WvJ/HhtB8a+Z55l30isrfWrvHF1joK4knhT7zNPM6gdrvZXKcBHOCyHbI7PtbkWWRIHYiKzqU6ic+VNzklUQPJj49ebLGvlNwn4wBycUiVFgTH1E/AUAHvwbwmazEMFm6xeZFJ4M0jSxGH+fvVqdOFNANIb3gNY9dSSV4PJHQ9UZ681CrkBJ3p9jF31Od3rX/vlLMajA3iHK7XiqmnAfVGOp984QMnI3UkEd31GUzxE+TMGQTZ9MzJlzGI9jvXrsZkGnBVHeSsynoVhP144S2u33/FRXyVaN8nP4JcwcZZ2+lGzEkTNtO+IRNtDg4RpffG/pc4rQx52rGLQABqKEGhoYkP/Q0k6//jE1nwFNVMv7+hqGAZ9omUM=
      KETCHUP_GITHUB_TOKEN: AgCy3zphvNEo/3vmenozm2M7BHZAy4MUDeaxZ9lxsT9Q4DD1lth8rZAGBL/HHfTHwcRshhf+8SUm8Z65O9ZqioKqbziectMoR2biIRnLlRvK4n455jrK6wa6twkZS8cJkMFGL6llccQ3wvtkq3BUCVfbyGpqG8Y3AFdLktC/zzQDOwcHDorv2OlIdYjqCKYoD9BiJgeSCRkIdIwKwYatrKOUQui8Ahb2ZDfL3/vkHQnD7qqpG+9u4sCv3H9HBExZt1sPWbiIX9X0HZmAha/syjewz0GTJfI8vFATh+P+6Q+Sa+cNJr1a4EXbuBHdcNmCeffueFXtQMMFsF9kKH2F6ImwxwcP5upOC60JD4bsHAE6+I47XgoYoquFB6A6nW6chyRLLWbNb1RK06z4S7dqKMJ6jUbjB2CQpC1SFW+Lt11/rfkkedXq71P+aZUw7cZG/mU3sAI7SOMmlBNOoesMhi/CBmglthgbeeTP9NCS7VuallY3AOh0+6VjZVRx+rCfPbkpFefKAZehMKTXNYTWmCdU56L5NFyazeyrNjCW7pHCgS60wPQPofb73+2VMnrEaHrwfXYSNzaNYN6CNTuMrIBzBDNCQ4VvdnxNrtrZ94zSvuIEtARgbguFFLNnvUrRDxq1/i+8CmtxItBNzXJWbCjfFqdxeF5K4RqvvXsoTuDNbFO7KXo1qL/bR567kDW4rH1M/cG9vzwa01lD6lq3fkd12pAZb/qBftR/0Zx54ne1GWBuheQKvoxq
      KETCHUP_MAILER_URL: AgCXTYyUHBOfCFqNxkwKBBUbEIhMNmCTGmo18+PyU9UdvPMe0W6PgwpL/pyek3Bff7OnIG2M8EY7+V4/sE79GtFGNi96Gprc3pmqHtcgifj3i2pE/QZA8Zhb97k+J8IF4oSrC9s1gEA+ZpDn+DR2aNZTA7tb87H+WiaLAZSrLao0zJp7134M3IQFh4ukasCDpJHiE07QPDtt+ljW0UFbwNVU4Z7XfBriLo1lOQZ8MAybPnOOq8Nt5k9I7QUs5yiZn05Q09AhHPiFXJShUlRszz1E6B6zKW7yiebfhlplZlzeTgir2zV/7Z5XkgLbMgwsikL5sepLq4SUqtxKDNOG0ZkWCLqBTYMYd3UhBH+v1x+Kiw4zXcqzz6OcmjpsBoxCIrFJtwBhaYCgDuyoQsYKnbC1eeFU4in+1kr29qw501fT2yjz6qQe9P5WfCrlw2JYL1ZvDgXFDnCy2uZh0pv5PgJm3Owqkad+eP9WGa11yjp9zo6aHxAWG9wU1DE8I8w/zE6nh+hI1nx9GBAV++tBzY1Ajj2N06hvir6zGPzAPxqecZOR9WdCFMZCa1G4sdrpEK7cjd5KNeNyG9y0MkfrJz2kwxTsqRzmEXpNBsrntDrDCubatBSaZ9P6JURciL9MOY+bO5afjCEqCilQNLicuNUZMfPEs1Z8YClTHrRh0+/V/x0frlIQYmb77xh3z4EJHuGDhcx7oEB9RIgAgKchLjX7qVJ+3Vl01ILqa04LJw8KP327AV/4RLLwSHC4gJu8z91DOLw=
      KETCHUP_DOCKER_PASSWORD: AgBk5cY9QFn79J9uId5RcFkh8zoSahMTM629NkjcM/AAlFbQMSLdaSeR25RKY+7i8rAqkhX20qBtnFHLb5MZu8fwroWg7lKrU7icW0xGO1J/RM9eV6UKtcsvSn+s5BWobpHqQ9s96f0yRkVJxD/8H9hUqkzqn02OKEdRB+lbfmP/rlCXXZTcMX3p02F1plKH1qnT9ApO5dlRcnBiz2R/oQSdrJ4y4uUWsZmbExnNfg6VmVRdgy4nV1vbLcdNytPRpJOwcsl/r17SPw619toxvreseSgN0uO3EpgoJuyKvEtWUIHQOHzSu3oSJl3BNn1XRfsTcDY9lQADWLbNzY9ynKZ1/oKuXQ4adGhm/utwiBP6nVE/IgmG6NaTyoWevfsjnSLxLTsgqxRCr/L0D4a5xguC+SUAO1nGxs7xXGYDZrfCne8zDdhborE4nVWyL6O3G/7bwc2neb0f8gin1MCKZNy1y5XPdLpNaoxQvM28mUqlvtu5FWDHWbs8a77sXPnGrOglsUBb3+rSURZWauc4izA3zB/nEaFL8k54g5TTGkaLO+6koaXxsE7ZjvZQu27Moq3Niwq1PUgazUBzMtF/5ij473VlM/U2swHeMrND5jDTVmrUUKMCWMUhYgnJ0pvEwRC/wyBXINkLeK3RPsjBr0JJh8ubImx5m1cdlDYe8XsVJ82BEzMlCZ5MYRRhm+JhqMZZm2DoUsTaveVG8ZC9YiyMHBcV0bEN3pzOewTYvOh0KiF5faE=
    containers:
      - name: job
        command:
          - /notifier
    resources:
      limits:
        memory: 128Mi
